<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Simulador Pro: Herramientas y M√∫sica</title>
    <style>
        :root {
            --bg-color: #2f3640;
            --panel-color: #353b48;
            --wire-phase: #c23616;
            --wire-neutral: #0097e6;
            --wire-earth: #44bd32;
            --wire-return: #7f8fa6;
            --neon-glow: #e67e22;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-color);
            margin: 0; overflow: hidden; touch-action: none;
            display: flex; flex-direction: column; height: 100vh; user-select: none;
            color: white;
        }

        /* --- HEADER & TOOLBAR --- */
        header {
            background: rgba(0,0,0,0.3); padding: 10px 20px;
            display: flex; justify-content: space-between; align-items: center;
            backdrop-filter: blur(5px); border-bottom: 1px solid #555; z-index: 50;
        }

        .toolbar { display: flex; gap: 10px; }
        
        .tool-btn {
            background: #2f3640; border: 1px solid #718093; color: #dcdde1;
            padding: 8px 15px; border-radius: 6px; cursor: pointer;
            display: flex; align-items: center; gap: 8px; transition: 0.2s;
            font-size: 0.9rem; font-weight: 500;
        }
        .tool-btn:hover { background: #353b48; border-color: #fff; }
        .tool-btn.active { 
            background: #00a8ff; border-color: #00a8ff; color: white; 
            box-shadow: 0 0 15px rgba(0, 168, 255, 0.4);
        }

        /* MUSIC CONTROLS */
        .music-player {
            display: flex; align-items: center; gap: 5px; 
            background: rgba(0,0,0,0.2); padding: 5px 10px; border-radius: 20px;
        }
        .music-btn {
            background: none; border: none; color: #fbc531; cursor: pointer; font-size: 1.2rem;
            transition: transform 0.1s;
        }
        .music-btn:active { transform: scale(0.9); }
        .music-display { font-size: 0.7rem; color: #aaa; width: 60px; text-align: center; }

        /* --- TABLERO --- */
        #game-board {
            position: relative; flex-grow: 1;
            background-image: 
                linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 40px 40px;
            cursor: default;
        }
        
        /* Cursor logic */
        #game-board[data-tool="hand"] { cursor: default; }
        #game-board[data-tool="buscapolo"] { cursor: none; } 
        #game-board[data-tool="tester"] { cursor: none; } 

        #wire-layer { position: absolute; width: 100%; height: 100%; pointer-events: none; z-index: 1; }

        /* --- HERRAMIENTAS FLOTANTES --- */
        
        /* BUSCAPOLO */
        #tool-buscapolo {
            position: absolute; width: 14px; height: 80px;
            background: linear-gradient(90deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.4) 100%);
            border: 1px solid rgba(255,255,255,0.3); border-radius: 4px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.5);
            pointer-events: none; display: none; z-index: 100;
            transform: translate(-7px, -80px); /* Punta en el cursor */
        }
        #tool-buscapolo::after { /* Punta met√°lica */
            content: ''; position: absolute; bottom: -15px; left: 4px;
            width: 6px; height: 15px; background: #bdc3c7;
            clip-path: polygon(0 0, 100% 0, 50% 100%);
        }
        #neon-light {
            width: 8px; height: 25px; background: #444; margin: 10px auto; border-radius: 2px;
            transition: 0.1s;
        }
        #tool-buscapolo.active #neon-light {
            background: #e67e22;
            box-shadow: 0 0 15px #e67e22, 0 0 30px red;
            animation: flicker 0.05s infinite alternate;
        }
        @keyframes flicker { from {opacity: 0.8;} to {opacity: 1;} }

        /* TESTER (MULT√çMETRO) */
        #tool-tester {
            position: absolute; width: 120px; background: #f1c40f;
            border: 3px solid #222; border-radius: 8px; padding: 10px;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.5);
            display: none; z-index: 90; top: 20px; left: 20px;
        }
        .lcd {
            background: #95a5a6; color: #111; font-family: 'Courier New', monospace;
            font-size: 1.5rem; text-align: right; padding: 5px; border: 2px inset #777;
            font-weight: bold; margin-bottom: 5px;
        }
        /* Puntas del tester */
        .probe {
            position: absolute; width: 8px; height: 60px;
            border-radius: 4px; z-index: 101; pointer-events: none; display: none;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.5);
            transform-origin: bottom center;
        }
        .probe::after { /* Punta metal */
            content:''; position: absolute; bottom: -15px; left: 2px;
            width: 4px; height: 15px; background: silver;
        }
        .probe-red { background: #c0392b; border: 1px solid #a93226; }
        .probe-black { background: #2d3436; border: 1px solid #000; }

        /* --- COMPONENTES --- */
        .component {
            position: absolute; background: #ecf0f1; border-radius: 6px;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3); z-index: 2;
            display: flex; flex-direction: column; align-items: center; color: #333;
        }
        
        .comp-board { width: 110px; height: 160px; background: #353b48; color: white; left: 5%; top: 15%; border: 2px solid #2f3640; }
        .breaker {
            width: 50px; height: 35px; background: #c0392b; margin: 15px; border-radius: 4px;
            cursor: pointer; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 0.7rem;
            box-shadow: inset 0 -3px rgba(0,0,0,0.3); transition: 0.2s; border: 1px solid #922b21;
        }
        .breaker.on { background: #27ae60; transform: translateY(2px); box-shadow: inset 0 2px rgba(0,0,0,0.3); border-color: #1e8449; }

        .comp-switch { width: 80px; height: 110px; left: 40%; top: 60%; }
        .rocker {
            width: 35px; height: 60px; background: #fff; border: 1px solid #bdc3c7; 
            margin-top: 10px; cursor: pointer; position: relative;
        }
        .rocker.active { border-left: 6px solid #bdc3c7; background: #ecf0f1; }

        .comp-lamp { width: 90px; height: 90px; border-radius: 50%; left: 70%; top: 30%; border: 4px solid #bdc3c7; }
        .bulb { width: 100%; height: 100%; border-radius: 50%; background: #bdc3c7; opacity: 0.4; transition: 0.3s; }
        .bulb.on { background: #f1c40f; opacity: 1; box-shadow: 0 0 80px #f1c40f; filter: brightness(1.2); }

        /* TERMINALES (NODOS) */
        .terminal {
            width: 20px; height: 20px; background: #bdc3c7; border: 3px solid #7f8c8d; border-radius: 50%;
            position: absolute; cursor: pointer; z-index: 10; transition: transform 0.2s;
        }
        .terminal:hover { transform: scale(1.2); border-color: #fff; background: #f1c40f; }
        .terminal.selected { background: #00a8ff; border-color: white; box-shadow: 0 0 10px #00a8ff; }
        
        .lbl { position: absolute; font-size: 10px; font-weight: bold; pointer-events: none; white-space: nowrap; }
        .lbl-w { color: white; } .lbl-b { color: #333; }

        /* CABLES */
        path.wire { 
            fill: none; stroke-width: 6; stroke-linecap: round; cursor: pointer; 
            filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.5));
        }
        path.wire:hover { stroke-width: 9; }

        /* MENSAJES FLOTANTES */
        #toast {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: #2f3640; color: white; padding: 10px 25px; border-radius: 30px;
            font-weight: bold; opacity: 0; transition: 0.3s; pointer-events: none; z-index: 2000; border: 1px solid #555;
        }
    </style>
</head>
<body>

    <!-- HERRAMIENTAS FLOTANTES -->
    <div id="tool-buscapolo">
        <div id="neon-light"></div>
    </div>

    <div id="tool-tester">
        <div class="lcd" id="tester-display">000</div>
        <div style="text-align:center; font-size:0.7rem; color:#222; font-weight:bold;">V~ AC 750</div>
    </div>
    <div id="probe-red" class="probe probe-red"></div>
    <div id="probe-black" class="probe probe-black"></div>

    <header>
        <div style="font-weight:bold; font-size:1.1rem;">‚ö° Simulador Pro</div>
        
        <div class="toolbar">
            <button class="tool-btn active" onclick="game.setTool('hand')" id="btn-hand">üñê Mano</button>
            <button class="tool-btn" onclick="game.setTool('buscapolo')" id="btn-busca">üí° Buscapolo</button>
            <button class="tool-btn" onclick="game.setTool('tester')" id="btn-tester">üìü Tester</button>
        </div>

        <div class="music-player">
            <button class="music-btn" onclick="audioSys.togglePlay()">‚èØ</button>
            <button class="music-btn" onclick="audioSys.nextTrack()">‚è≠</button>
            <div class="music-display" id="track-name">OFF</div>
        </div>
    </header>

    <div id="game-board" data-tool="hand">
        <svg id="wire-layer"></svg>

        <!-- 1. TABLERO -->
        <div class="component comp-board">
            <div style="font-weight:bold; margin-top:10px;">TABLERO</div>
            <div id="breaker" class="breaker" onclick="game.toggleBreaker()">OFF</div>
            
            <div style="position:relative; height:100px; width:100%;">
                <span class="lbl lbl-w" style="top:12px; right:35px;">L</span>
                <div class="terminal" id="t-src-L" style="top:10px; right:-10px; background:var(--wire-phase);"></div>
                
                <span class="lbl lbl-w" style="top:42px; right:35px;">N</span>
                <div class="terminal" id="t-src-N" style="top:40px; right:-10px; background:var(--wire-neutral);"></div>
                
                <span class="lbl lbl-w" style="top:72px; right:35px;">T</span>
                <div class="terminal" id="t-src-E" style="top:70px; right:-10px; background:var(--wire-earth);"></div>
            </div>
        </div>

        <!-- 2. TECLA -->
        <div class="component comp-switch">
            <div style="font-weight:bold; font-size:0.8rem; margin-top:5px;">TECLA</div>
            <div class="terminal" id="t-sw-in" style="top:25px; left:-10px;"></div>
            <span class="lbl lbl-b" style="top:27px; left:15px;">L</span>
            
            <div class="terminal" id="t-sw-out" style="top:75px; right:-10px;"></div>
            <span class="lbl lbl-b" style="top:77px; right:15px;">1</span>
            
            <div class="rocker" id="sw-btn" onclick="game.toggleSwitch()"></div>
        </div>

        <!-- 3. L√ÅMPARA -->
        <div class="component comp-lamp">
            <div class="bulb" id="bulb"></div>
            <div class="terminal" id="t-lmp-L" style="bottom:-5px; left:10px;"></div>
            <span class="lbl lbl-b" style="bottom:12px; left:18px;">Ret</span>
            
            <div class="terminal" id="t-lmp-N" style="bottom:-5px; right:10px;"></div>
            <span class="lbl lbl-b" style="bottom:12px; right:18px;">Neu</span>
            
            <div class="terminal" id="t-lmp-E" style="top:-5px; left:35px; background:var(--wire-earth);"></div>
        </div>

        <div id="toast"></div>
    </div>

    <script>
        const svgNS = "http://www.w3.org/2000/svg";

        // --- SISTEMA DE AUDIO (SINTETIZADOR) ---
        class AudioSynth {
            constructor() {
                this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                this.isPlaying = false;
                this.currentTrack = 0;
                this.noteTime = 0;
                this.tempo = 140; // BPM
                this.tracks = [
                    { name: "Chill", notes: [261,293,329,392, 329,293, 261, 0, 261,329,392,523, 392,329,261,0] }, // C Major
                    { name: "Focus", notes: [440,0,440,0, 493,0,523,0, 440,0,392,0, 349,0,329,0] }, // A Minor
                    { name: "Funky", notes: [196,196, 293,0, 196,0, 329, 293, 196,0, 261, 246, 196, 0, 0, 0] } 
                ];
                this.timerID = null;
                this.noteIndex = 0;
            }

            togglePlay() {
                if(this.ctx.state === 'suspended') this.ctx.resume();
                this.isPlaying = !this.isPlaying;
                document.getElementById('track-name').textContent = this.isPlaying ? this.tracks[this.currentTrack].name : "PAUSA";
                
                if(this.isPlaying) this.scheduler();
                else clearTimeout(this.timerID);
            }

            nextTrack() {
                this.currentTrack = (this.currentTrack + 1) % this.tracks.length;
                if(this.isPlaying) {
                    document.getElementById('track-name').textContent = this.tracks[this.currentTrack].name;
                    this.noteIndex = 0;
                }
            }

            scheduler() {
                const track = this.tracks[this.currentTrack];
                const note = track.notes[this.noteIndex];
                
                if(note > 0) this.playTone(note, 0.2); // Play note
                
                this.noteIndex = (this.noteIndex + 1) % track.notes.length;
                
                const interval = (60 / this.tempo) * 1000 / 2; // 8th notes
                this.timerID = setTimeout(() => {
                    if(this.isPlaying) this.scheduler();
                }, interval);
            }

            playTone(freq, dur) {
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'triangle'; // Retro sound
                osc.frequency.value = freq;
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                gain.gain.setValueAtTime(0.05, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.001, this.ctx.currentTime + dur);
                osc.start();
                osc.stop(this.ctx.currentTime + dur);
            }
        }

        // --- SIMULADOR ---
        class Simulator {
            constructor() {
                this.wires = [];
                this.breakerOn = false;
                this.switchOn = false;
                this.tool = 'hand'; // hand, buscapolo, tester
                this.selectedTerminal = null;
                
                // Tester state
                this.probeRedNode = null;
                this.probeBlackNode = null;

                // DOM
                this.board = document.getElementById('game-board');
                this.svg = document.getElementById('wire-layer');
                this.tools = {
                    buscapolo: document.getElementById('tool-buscapolo'),
                    tester: document.getElementById('tool-tester'),
                    probeRed: document.getElementById('probe-red'),
                    probeBlack: document.getElementById('probe-black'),
                    display: document.getElementById('tester-display')
                };

                this.initInteraction();
                this.showToast("Bienvenido. Usa la Mano para cablear.");
            }

            // --- HERRAMIENTAS ---
            setTool(toolName) {
                this.tool = toolName;
                this.board.dataset.tool = toolName;
                this.selectedTerminal = null;
                this.updateTerminalStyles();

                // UI Reset
                document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
                if(toolName === 'hand') document.getElementById('btn-hand').classList.add('active');
                if(toolName === 'buscapolo') document.getElementById('btn-busca').classList.add('active');
                if(toolName === 'tester') document.getElementById('btn-tester').classList.add('active');

                // Ocultar herramientas
                this.tools.buscapolo.style.display = 'none';
                this.tools.tester.style.display = 'none';
                this.tools.probeRed.style.display = 'none';
                this.tools.probeBlack.style.display = 'none';

                // Mostrar seleccionada
                if(toolName === 'tester') {
                    this.tools.tester.style.display = 'block';
                    this.tools.probeRed.style.display = 'block';
                    this.tools.probeBlack.style.display = 'block';
                    this.tools.display.textContent = "000";
                    // Reset probes
                    this.probeRedNode = null;
                    this.probeBlackNode = null;
                }
            }

            // --- L√ìGICA EL√âCTRICA (POTENCIALES) ---
            calculatePotentials() {
                const map = new Map(); // id -> voltage (220, 0, or undefined)
                if(!this.breakerOn) return map;

                const adj = this.buildAdjacency();

                // 1. Fase (220V)
                this.bfs(adj, 't-src-L', node => map.set(node, 220));
                
                // Si tecla ON y llega fase, pasa
                if(this.switchOn && map.get('t-sw-in') === 220) {
                    this.bfs(adj, 't-sw-out', node => map.set(node, 220));
                }

                // 2. Neutro (0V)
                // Usamos conjunto separado para no sobreescribir fase en caso de corto
                const neutrals = new Set();
                this.bfs(adj, 't-src-N', node => neutrals.add(node));
                neutrals.forEach(n => {
                    if(!map.has(n)) map.set(n, 0); // Solo si no es fase
                });

                // 3. Tierra (0V pero seguro)
                const earths = new Set();
                this.bfs(adj, 't-src-E', node => earths.add(node));
                earths.forEach(n => {
                    if(!map.has(n)) map.set(n, 0); 
                });

                return map;
            }

            updateCircuit() {
                const map = this.calculatePotentials();
                
                // L√°mpara
                const lmpL = map.get('t-lmp-L');
                const lmpN = map.get('t-lmp-N');
                
                const bulb = document.getElementById('bulb');
                if(lmpL === 220 && lmpN === 0) {
                    bulb.classList.add('on');
                } else {
                    bulb.classList.remove('on');
                }

                // Actualizar Tester si est√° activo
                if(this.tool === 'tester') this.updateTesterDisplay(map);
            }

            // --- INTERACCI√ìN CABLES ---
            clickTerminal(id) {
                if(this.tool !== 'hand') return; // Solo mano conecta
                if(this.breakerOn) { this.showToast("‚ö†Ô∏è Corta la luz primero!"); return; }

                if(!this.selectedTerminal) {
                    this.selectedTerminal = id;
                    this.updateTerminalStyles();
                } else {
                    if(this.selectedTerminal !== id) {
                        this.addWire(this.selectedTerminal, id);
                    }
                    this.selectedTerminal = null;
                    this.updateTerminalStyles();
                }
            }

            addWire(u, v) {
                if(this.wires.find(w => (w.u===u && w.v===v) || (w.u===v && w.v===u))) return;

                // Color l√≥gico
                let color = '#7f8fa6';
                if(u.includes('L') || v.includes('L')) color = 'var(--wire-phase)';
                else if(u.includes('N') || v.includes('N')) color = 'var(--wire-neutral)';
                else if(u.includes('E') || v.includes('E')) color = 'var(--wire-earth)';
                else color = 'var(--wire-return)';

                const path = document.createElementNS(svgNS, 'path');
                path.classList.add('wire');
                path.setAttribute('stroke', color);
                this.svg.appendChild(path);

                const wire = { u, v, el: path };
                this.wires.push(wire);
                
                // Click derecho para borrar
                path.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    if(this.tool === 'hand' && !this.breakerOn) {
                        path.remove();
                        this.wires = this.wires.filter(w => w !== wire);
                        this.updateCircuit();
                    } else if(this.breakerOn) {
                        this.showToast("‚ö†Ô∏è Corta la luz para quitar cables");
                    }
                });

                this.drawWires();
                this.updateCircuit();
            }

            // --- HERRAMIENTAS L√ìGICA ---
            handleMouseMove(e) {
                const rect = this.board.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                // 1. Buscapolo
                if(this.tool === 'buscapolo') {
                    this.tools.buscapolo.style.display = 'block';
                    this.tools.buscapolo.style.left = x + 'px';
                    this.tools.buscapolo.style.top = y + 'px';
                    
                    // Detectar Tensi√≥n
                    const el = document.elementFromPoint(e.clientX, e.clientY);
                    let active = false;
                    
                    if(this.breakerOn) {
                        const map = this.calculatePotentials();
                        // Sobre terminal
                        if(el.classList.contains('terminal')) {
                            if(map.get(el.id) === 220) active = true;
                        }
                        // Sobre cable (aproximado por l√≥gica de extremos)
                        if(el.classList.contains('wire')) {
                            const w = this.wires.find(w => w.el === el);
                            if(w && (map.get(w.u) === 220 || map.get(w.v) === 220)) active = true;
                        }
                    }
                    
                    if(active) this.tools.buscapolo.classList.add('active');
                    else this.tools.buscapolo.classList.remove('active');
                }

                // 2. Tester (Mover puntas)
                if(this.tool === 'tester') {
                    // Mover puntas con el mouse (simulado: la roja sigue al mouse, la negra offset)
                    // Para hacerlo usable: click para fijar punta no implementado por simplicidad,
                    // aqu√≠ arrastramos el "set" de puntas. Para medir bien, necesitar√≠amos drag&drop individual.
                    // **Soluci√≥n UX:** Arrastra el tester, y si las puntas virtuales tocan nodos, mide.
                    
                    // Simplificaci√≥n para jugabilidad fluida:
                    // Puntas siguen al mouse separadas.
                    this.tools.probeRed.style.left = (x - 10) + 'px';
                    this.tools.probeRed.style.top = (y - 60) + 'px';
                    
                    this.tools.probeBlack.style.left = (x + 20) + 'px';
                    this.tools.probeBlack.style.top = (y - 60) + 'px';

                    // Detectar nodos bajo puntas
                    const elRed = document.elementFromPoint(e.clientX - 10, e.clientY); // Ajuste fino
                    const elBlack = document.elementFromPoint(e.clientX + 20, e.clientY);

                    this.probeRedNode = elRed && elRed.classList.contains('terminal') ? elRed.id : null;
                    this.probeBlackNode = elBlack && elBlack.classList.contains('terminal') ? elBlack.id : null;
                    
                    this.updateTesterDisplay(this.calculatePotentials());
                }
            }

            updateTesterDisplay(map) {
                if(this.probeRedNode && this.probeBlackNode) {
                    const v1 = map.get(this.probeRedNode) || 0;
                    const v2 = map.get(this.probeBlackNode) || 0;
                    const diff = Math.abs(v1 - v2);
                    this.tools.display.textContent = diff > 0 ? diff : "000";
                } else {
                    this.tools.display.textContent = "000";
                }
            }

            // --- CONTROLES ---
            toggleBreaker() {
                this.breakerOn = !this.breakerOn;
                const b = document.getElementById('breaker');
                if(this.breakerOn) b.classList.add('on'); else b.classList.remove('on');
                this.updateCircuit();
            }
            toggleSwitch() {
                this.switchOn = !this.switchOn;
                const s = document.getElementById('sw-btn');
                if(this.switchOn) s.classList.add('active'); else s.classList.remove('active');
                this.updateCircuit();
            }

            // --- UTILS ---
            buildAdjacency() {
                const adj = {};
                this.wires.forEach(w => {
                    if(!adj[w.u]) adj[w.u]=[]; if(!adj[w.v]) adj[w.v]=[];
                    adj[w.u].push(w.v); adj[w.v].push(w.u);
                });
                return adj;
            }
            bfs(adj, s, cb) {
                if(!adj[s]) return;
                const q=[s], v=new Set([s]);
                while(q.length){ const u=q.shift(); cb(u); if(adj[u]) for(let n of adj[u]) if(!v.has(n)){v.add(n);q.push(n);} }
            }
            
            drawWires() {
                this.wires.forEach(w => {
                    const r1 = document.getElementById(w.u).getBoundingClientRect();
                    const r2 = document.getElementById(w.v).getBoundingClientRect();
                    const br = this.board.getBoundingClientRect();
                    
                    const x1 = r1.left + r1.width/2 - br.left;
                    const y1 = r1.top + r1.height/2 - br.top;
                    const x2 = r2.left + r2.width/2 - br.left;
                    const y2 = r2.top + r2.height/2 - br.top;

                    // Curva B√©zier "U"
                    const cp1x = x1, cp1y = Math.max(y1,y2) + 60;
                    const cp2x = x2, cp2y = Math.max(y1,y2) + 60;
                    
                    w.el.setAttribute('d', `M ${x1} ${y1} C ${cp1x} ${cp1y}, ${cp2x} ${cp2y}, ${x2} ${y2}`);
                });
            }

            updateTerminalStyles() {
                document.querySelectorAll('.terminal').forEach(t => t.classList.remove('selected'));
                if(this.selectedTerminal) document.getElementById(this.selectedTerminal).classList.add('selected');
            }

            showToast(msg) {
                const t = document.getElementById('toast');
                t.textContent = msg; t.style.opacity = 1;
                setTimeout(() => t.style.opacity = 0, 2000);
            }

            initInteraction() {
                document.querySelectorAll('.terminal').forEach(t => {
                    t.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.clickTerminal(t.id);
                    });
                });
                window.addEventListener('mousemove', (e) => this.handleMouseMove(e));
                window.addEventListener('resize', () => this.drawWires());
            }
        }

        const audioSys = new AudioSynth();
        const game = new Simulator();
    </script>
</body>
</html>
